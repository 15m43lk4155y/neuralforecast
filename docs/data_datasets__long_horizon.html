---

title: Long-Horizon Datasets


keywords: fastai
sidebar: home_sidebar

summary: "Download and wrangling utility for long-horizon datasets."
description: "Download and wrangling utility for long-horizon datasets."
nb_path: "nbs/data_datasets__long_horizon.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/data_datasets__long_horizon.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote><p>Long-Horizon Meta Information</p>
</blockquote>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ETTh1" class="doc_header"><code>class</code> <code>ETTh1</code><a href="https://github.com/Nixtla/neuralforecast/tree/main/neuralforecast/data/datasets/long_horizon.py#L18" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ETTh1</code>(<strong><code>freq</code></strong>:<code>str</code>=<em><code>'H'</code></em>, <strong><code>name</code></strong>:<code>str</code>=<em><code>'ETTh1'</code></em>, <strong><code>n_ts</code></strong>:<code>int</code>=<em><code>1</code></em>, <strong><code>test_size</code></strong>:<code>int</code>=<em><code>11520</code></em>, <strong><code>val_size</code></strong>:<code>int</code>=<em><code>11520</code></em>, <strong><code>horizons</code></strong>:<code>Tuple</code>[<code>int</code>]=<em><code>(96, 192, 336, 720)</code></em>)</p>
</blockquote>
<p>The ETTh1 dataset monitors an electricity transformer
from a region of a province of China including oil temperature
and variants of load (such as high useful load and high useless load)
from July 2016 to July 2018 at an hourly frequency.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ETTh2" class="doc_header"><code>class</code> <code>ETTh2</code><a href="https://github.com/Nixtla/neuralforecast/tree/main/neuralforecast/data/datasets/long_horizon.py#L33" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ETTh2</code>(<strong><code>freq</code></strong>:<code>str</code>=<em><code>'H'</code></em>, <strong><code>name</code></strong>:<code>str</code>=<em><code>'ETTh2'</code></em>, <strong><code>n_ts</code></strong>:<code>int</code>=<em><code>1</code></em>, <strong><code>test_size</code></strong>:<code>int</code>=<em><code>11520</code></em>, <strong><code>val_size</code></strong>:<code>int</code>=<em><code>11520</code></em>, <strong><code>horizons</code></strong>:<code>Tuple</code>[<code>int</code>]=<em><code>(96, 192, 336, 720)</code></em>)</p>
</blockquote>
<p>The ETTh2 dataset monitors an electricity transformer
from a region of a province of China including oil temperature
and variants of load (such as high useful load and high useless load)
from July 2016 to July 2018 at an hourly frequency.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ETTm1" class="doc_header"><code>class</code> <code>ETTm1</code><a href="https://github.com/Nixtla/neuralforecast/tree/main/neuralforecast/data/datasets/long_horizon.py#L48" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ETTm1</code>(<strong><code>freq</code></strong>:<code>str</code>=<em><code>'15T'</code></em>, <strong><code>name</code></strong>:<code>str</code>=<em><code>'ETTm1'</code></em>, <strong><code>n_ts</code></strong>:<code>int</code>=<em><code>7</code></em>, <strong><code>test_size</code></strong>:<code>int</code>=<em><code>11520</code></em>, <strong><code>val_size</code></strong>:<code>int</code>=<em><code>11520</code></em>, <strong><code>horizons</code></strong>:<code>Tuple</code>[<code>int</code>]=<em><code>(96, 192, 336, 720)</code></em>)</p>
</blockquote>
<p>The ETTm1 dataset monitors an electricity transformer
from a region of a province of China including oil temperature
and variants of load (such as high useful load and high useless load)
from July 2016 to July 2018 at a fifteen minute frequency.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ETTm2" class="doc_header"><code>class</code> <code>ETTm2</code><a href="https://github.com/Nixtla/neuralforecast/tree/main/neuralforecast/data/datasets/long_horizon.py#L63" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ETTm2</code>(<strong><code>freq</code></strong>:<code>str</code>=<em><code>'15T'</code></em>, <strong><code>name</code></strong>:<code>str</code>=<em><code>'ETTm2'</code></em>, <strong><code>n_ts</code></strong>:<code>int</code>=<em><code>7</code></em>, <strong><code>test_size</code></strong>:<code>int</code>=<em><code>11520</code></em>, <strong><code>val_size</code></strong>:<code>int</code>=<em><code>11520</code></em>, <strong><code>horizons</code></strong>:<code>Tuple</code>[<code>int</code>]=<em><code>(96, 192, 336, 720)</code></em>)</p>
</blockquote>
<p>The ETTm2 dataset monitors an electricity transformer
from a region of a province of China including oil temperature
and variants of load (such as high useful load and high useless load)
from July 2016 to July 2018 at a fifteen minute frequency.</p>

<pre><code>Reference:
Zhou, et al. Informer: Beyond Efficient Transformer
for Long Sequence Time-Series Forecasting. AAAI 2021.
https://arxiv.org/abs/2012.07436</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ECL" class="doc_header"><code>class</code> <code>ECL</code><a href="https://github.com/Nixtla/neuralforecast/tree/main/neuralforecast/data/datasets/long_horizon.py#L84" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ECL</code>(<strong><code>freq</code></strong>:<code>str</code>=<em><code>'15T'</code></em>, <strong><code>name</code></strong>:<code>str</code>=<em><code>'ECL'</code></em>, <strong><code>n_ts</code></strong>:<code>int</code>=<em><code>321</code></em>, <strong><code>test_size</code></strong>:<code>int</code>=<em><code>5260</code></em>, <strong><code>val_size</code></strong>:<code>int</code>=<em><code>2632</code></em>, <strong><code>horizons</code></strong>:<code>Tuple</code>[<code>int</code>]=<em><code>(96, 192, 336, 720)</code></em>)</p>
</blockquote>
<p>The Electricity dataset reports the fifteen minute electricity
consumption (KWh) of 321 customers from 2012 to 2014.
For comparability, we aggregate it hourly.</p>

<pre><code>Reference:
Li, S et al. Enhancing the locality and breaking the memory
bottleneck of Transformer on time series forecasting.
NeurIPS 2019. http://arxiv.org/abs/1907.00235.</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Exchange" class="doc_header"><code>class</code> <code>Exchange</code><a href="https://github.com/Nixtla/neuralforecast/tree/main/neuralforecast/data/datasets/long_horizon.py#L104" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Exchange</code>(<strong><code>freq</code></strong>:<code>str</code>=<em><code>'D'</code></em>, <strong><code>name</code></strong>:<code>str</code>=<em><code>'Exchange'</code></em>, <strong><code>n_ts</code></strong>:<code>int</code>=<em><code>8</code></em>, <strong><code>test_size</code></strong>:<code>int</code>=<em><code>1517</code></em>, <strong><code>val_size</code></strong>:<code>int</code>=<em><code>760</code></em>, <strong><code>horizons</code></strong>:<code>Tuple</code>[<code>int</code>]=<em><code>(96, 192, 336, 720)</code></em>)</p>
</blockquote>
<p>The Exchange dataset is a collection of daily exchange rates of
eight countries relative to the US dollar. The countries include
Australia, UK, Canada, Switzerland, China, Japan, New Zealand and
Singapore from 1990 to 2016.</p>

<pre><code>Reference:
Lai, G., Chang, W., Yang, Y., and Liu, H. Modeling Long and
Short-Term Temporal Patterns with Deep Neural Networks.
SIGIR 2018. http://arxiv.org/abs/1703.07015.</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="TrafficL" class="doc_header"><code>class</code> <code>TrafficL</code><a href="https://github.com/Nixtla/neuralforecast/tree/main/neuralforecast/data/datasets/long_horizon.py#L125" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>TrafficL</code>(<strong><code>freq</code></strong>:<code>str</code>=<em><code>'H'</code></em>, <strong><code>name</code></strong>:<code>str</code>=<em><code>'traffic'</code></em>, <strong><code>n_ts</code></strong>:<code>int</code>=<em><code>862</code></em>, <strong><code>test_size</code></strong>:<code>int</code>=<em><code>3508</code></em>, <strong><code>val_size</code></strong>:<code>int</code>=<em><code>1756</code></em>, <strong><code>horizons</code></strong>:<code>Tuple</code>[<code>int</code>]=<em><code>(96, 192, 336, 720)</code></em>)</p>
</blockquote>
<p>This large Traffic dataset was collected by the California Department
of Transportation, it reports road hourly occupancy rates of 862 sensors,
from January 2015 to December 2016.</p>

<pre><code>Reference:
Lai, G., Chang, W., Yang, Y., and Liu, H. Modeling Long and
Short-Term Temporal Patterns with Deep Neural Networks.
SIGIR 2018. http://arxiv.org/abs/1703.07015.

Wu, H., Xu, J., Wang, J., and Long, M. Autoformer:
Decomposition Transformers with auto-correlation for
long-term series forecasting. NeurIPS 2021.
https://arxiv.org/abs/2106.13008.</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ILI" class="doc_header"><code>class</code> <code>ILI</code><a href="https://github.com/Nixtla/neuralforecast/tree/main/neuralforecast/data/datasets/long_horizon.py#L150" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ILI</code>(<strong><code>freq</code></strong>:<code>str</code>=<em><code>'W'</code></em>, <strong><code>name</code></strong>:<code>str</code>=<em><code>'ili'</code></em>, <strong><code>n_ts</code></strong>:<code>int</code>=<em><code>7</code></em>, <strong><code>test_size</code></strong>:<code>int</code>=<em><code>193</code></em>, <strong><code>val_size</code></strong>:<code>int</code>=<em><code>97</code></em>, <strong><code>horizons</code></strong>:<code>Tuple</code>[<code>int</code>]=<em><code>(24, 36, 48, 60)</code></em>)</p>
</blockquote>
<p>This dataset reports weekly recorded influenza-like illness (ILI)
patients from Centers for Disease Control and Prevention of the
United States from 2002 to 2021. It is measured as a ratio of ILI
patients versus the total patients in the week.</p>

<pre><code>Reference:
Wu, H., Xu, J., Wang, J., and Long, M. Autoformer:
Decomposition Transformers with auto-correlation for
long-term series forecasting. NeurIPS 2021.
https://arxiv.org/abs/2106.13008.</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Weather" class="doc_header"><code>class</code> <code>Weather</code><a href="https://github.com/Nixtla/neuralforecast/tree/main/neuralforecast/data/datasets/long_horizon.py#L172" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Weather</code>(<strong><code>freq</code></strong>:<code>str</code>=<em><code>'10M'</code></em>, <strong><code>name</code></strong>:<code>str</code>=<em><code>'weather'</code></em>, <strong><code>n_ts</code></strong>:<code>int</code>=<em><code>21</code></em>, <strong><code>test_size</code></strong>:<code>int</code>=<em><code>10539</code></em>, <strong><code>val_size</code></strong>:<code>int</code>=<em><code>5270</code></em>, <strong><code>horizons</code></strong>:<code>Tuple</code>[<code>int</code>]=<em><code>(96, 192, 336, 720)</code></em>)</p>
</blockquote>
<p>This Weather dataset contains the 2020 year of 21 meteorological
measurements
recorded every 10 minutes from the Weather Station of the Max Planck Biogeochemistry
Institute in Jena, Germany.</p>

<pre><code>Reference:
Wu, H., Xu, J., Wang, J., and Long, M. Autoformer:
Decomposition Transformers with auto-correlation for
long-term series forecasting. NeurIPS 2021.
https://arxiv.org/abs/2106.13008.</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="LongHorizon" class="doc_header"><code>class</code> <code>LongHorizon</code><a href="https://github.com/Nixtla/neuralforecast/tree/main/neuralforecast/data/datasets/long_horizon.py#L205" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>LongHorizon</code>(<strong><code>source_url</code></strong>:<code>str</code>=<em><code>'https://nhits-experiments.s3.amazonaws.com/datasets.zip'</code></em>)</p>
</blockquote>
<p>This Long-Horizon datasets wrapper class, provides
with utility to download and wrangle the following datasets:
ETT, ECL, Exchange, Traffic, ILI and Weather.</p>
<ul>
<li>Each set is normalized with the train data mean and standard deviation.</li>
<li>Datasets are partitioned into train, validation and test splits.</li>
<li>For all datasets: 70%, 10%, and 20% of observations are train, validation, test,
except ETT that uses 20% validation.</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">group</span><span class="p">,</span> <span class="n">meta</span> <span class="ow">in</span> <span class="n">LongHorizonInfo</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">group</span><span class="p">)</span>

<span class="n">group</span> <span class="o">=</span> <span class="s1">&#39;ETTm2&#39;</span>
<span class="n">y_df</span><span class="p">,</span> <span class="n">x_df</span><span class="p">,</span> <span class="n">s_df</span> <span class="o">=</span> <span class="n">LongHorizon</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">directory</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="n">group</span><span class="p">,</span> <span class="n">cache</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">n_series</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y_df</span><span class="o">.</span><span class="n">unique_id</span><span class="o">.</span><span class="n">values</span><span class="p">))</span>
<span class="n">ex_vars</span> <span class="o">=</span> <span class="n">x_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
<span class="n">ex_vars</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;unique_id&#39;</span><span class="p">)</span>
<span class="n">ex_vars</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;ds&#39;</span><span class="p">)</span>

<span class="n">display_str</span>  <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Group: </span><span class="si">{</span><span class="n">group</span><span class="si">}</span><span class="s1"> &#39;</span>
<span class="n">display_str</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;n_series: </span><span class="si">{</span><span class="n">n_series</span><span class="si">}</span><span class="s1"> &#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">display_str</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>
 

