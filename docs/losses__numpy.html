---

title: NumPy Evaluation Metrics


keywords: fastai
sidebar: home_sidebar

summary: "Metrics for evaluation."
description: "Metrics for evaluation."
nb_path: "nbs/losses__numpy.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/losses__numpy.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Mean-Absolute-Percentage-Error">Mean Absolute Percentage Error<a class="anchor-link" href="#Mean-Absolute-Percentage-Error"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="mape" class="doc_header"><code>mape</code><a href="https://github.com/Nixtla/neuralforecast/tree/main/neuralforecast/losses/numpy.py#L27" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>mape</code>(<strong><code>y</code></strong>:<code>ndarray</code>, <strong><code>y_hat</code></strong>:<code>ndarray</code>, <strong><code>weights</code></strong>:<code>Optional</code>[<code>ndarray</code>]=<em><code>None</code></em>, <strong><code>axis</code></strong>:<code>Optional</code>[<code>int</code>]=<em><code>None</code></em>)</p>
</blockquote>
<p>Calculates Mean Absolute Percentage Error (MAPE)
that measures the relative prediction accuracy of a
forecasting method by calculating the percentual deviation
of the prediction and the true value at a given time and
averages these devations over the length of the series.</p>

<pre><code>Parameters
----------
y: numpy array
    Actual test values.
y_hat: numpy array
    Predicted values.
weights: numpy array, optional
    Weights for weighted average.
axis: None or int, optional
    Axis or axes along which to average a.
    The default, axis=None, will average over all of the
    elements of the input array.
    If axis is negative it counts
    from the last to the first axis.

Returns
-------
mape: numpy array or double
    Return the mape along the specified axis.</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Mean-Squared-Error">Mean Squared Error<a class="anchor-link" href="#Mean-Squared-Error"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="mse" class="doc_header"><code>mse</code><a href="https://github.com/Nixtla/neuralforecast/tree/main/neuralforecast/losses/numpy.py#L69" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>mse</code>(<strong><code>y</code></strong>:<code>ndarray</code>, <strong><code>y_hat</code></strong>:<code>ndarray</code>, <strong><code>weights</code></strong>:<code>Optional</code>[<code>ndarray</code>]=<em><code>None</code></em>, <strong><code>axis</code></strong>:<code>Optional</code>[<code>int</code>]=<em><code>None</code></em>)</p>
</blockquote>
<p>Calculates Mean Squared Error (MSE)
that measures the prediction accuracy of a
forecasting method by calculating the squared deviation
of the prediction and the true value at a given time and
averages these devations over the length of the series.</p>

<pre><code>Parameters
----------
y: numpy array
    Actual test values.
y_hat: numpy array
    Predicted values.
weights: numpy array
    Weights for weighted average.
axis: None or int, optional
    Axis or axes along which to average a.
    The default, axis=None, will average over all of the
    elements of the input array.
    If axis is negative it counts
    from the last to the first axis.

Returns
-------
mse: numpy array or double
    Return the mse along the specified axis.</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Root-Mean-Squared-Error">Root Mean Squared Error<a class="anchor-link" href="#Root-Mean-Squared-Error"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="rmse" class="doc_header"><code>rmse</code><a href="https://github.com/Nixtla/neuralforecast/tree/main/neuralforecast/losses/numpy.py#L113" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>rmse</code>(<strong><code>y</code></strong>:<code>ndarray</code>, <strong><code>y_hat</code></strong>:<code>ndarray</code>, <strong><code>weights</code></strong>:<code>Optional</code>[<code>ndarray</code>]=<em><code>None</code></em>, <strong><code>axis</code></strong>:<code>Optional</code>[<code>int</code>]=<em><code>None</code></em>)</p>
</blockquote>
<p>Calculates Root Mean Squared Error (RMSE)
that measures the prediction accuracy of a
forecasting method by calculating the squared deviation
of the prediction and the true value at a given time and
averages these devations over the length of the series.
Finally the RMSE will be in the same scale
as the original time series so its comparison with other
series is possible only if they share a common scale.</p>

<pre><code>Parameters
----------
y: numpy array
    Actual test values.
y_hat: numpy array
    Predicted values.
weights: numpy array
    Weights for weighted average.
axis: None or int, optional
    Axis or axes along which to average a.
    The default, axis=None, will average over all of the
    elements of the input array.
    If axis is negative it counts
    from the last to the first axis.

Returns
-------
rmse: numpy array or double
    Return the rmse along the specified axis.</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Symmetric-Mean-Absolute-Percentage-Error">Symmetric Mean Absolute Percentage Error<a class="anchor-link" href="#Symmetric-Mean-Absolute-Percentage-Error"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="smape" class="doc_header"><code>smape</code><a href="https://github.com/Nixtla/neuralforecast/tree/main/neuralforecast/losses/numpy.py#L151" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>smape</code>(<strong><code>y</code></strong>:<code>ndarray</code>, <strong><code>y_hat</code></strong>:<code>ndarray</code>, <strong><code>weights</code></strong>:<code>Optional</code>[<code>ndarray</code>]=<em><code>None</code></em>, <strong><code>axis</code></strong>:<code>Optional</code>[<code>int</code>]=<em><code>None</code></em>)</p>
</blockquote>
<p>Calculates Symmetric Mean Absolute Percentage Error (SMAPE)
that measures the relative prediction accuracy of a
forecasting method by calculating the relative deviation
of the prediction and the true value scaled by the sum of the
absolute values for the prediction and true value at a
given time, then averages these devations over the length
of the series. This allows the SMAPE to have bounds between
0% and 200% which is desireble compared to normal MAPE that
may be undetermined.</p>

<pre><code>Parameters
----------
y: numpy array
    Actual test values.
y_hat: numpy array
    Predicted values.
weights: numpy array
    Weights for weighted average.
axis: None or int, optional
    Axis or axes along which to average a.
    The default, axis=None, will average over all of the
    elements of the input array.
    If axis is negative it counts
    from the last to the first axis.

Returns
-------
smape: numpy array or double
    Return the smape along the specified axis.</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Mean-Absolute-Scaled-Error">Mean Absolute Scaled Error<a class="anchor-link" href="#Mean-Absolute-Scaled-Error"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="mase" class="doc_header"><code>mase</code><a href="https://github.com/Nixtla/neuralforecast/tree/main/neuralforecast/losses/numpy.py#L201" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>mase</code>(<strong><code>y</code></strong>:<code>ndarray</code>, <strong><code>y_hat</code></strong>:<code>ndarray</code>, <strong><code>y_train</code></strong>:<code>ndarray</code>, <strong><code>seasonality</code></strong>:<code>int</code>, <strong><code>weights</code></strong>:<code>Optional</code>[<code>ndarray</code>]=<em><code>None</code></em>, <strong><code>axis</code></strong>:<code>Optional</code>[<code>int</code>]=<em><code>None</code></em>)</p>
</blockquote>
<p>Calculates the Mean Absolute Scaled Error (MASE)
that measures the relative prediction accuracy of a
forecasting method by comparinng the mean absolute errors
of the prediction and the true value against the mean
absolute errors of the seasonal naive model.</p>

<pre><code>Parameters
----------
y: numpy array
    Actual test values.
y_hat: numpy array
    Predicted values.
y_train: numpy array
    Actual insample values for Seasonal Naive predictions.
seasonality: int
    Main frequency of the time series
    Hourly 24,  Daily 7, Weekly 52,
    Monthly 12, Quarterly 4, Yearly 1.
weights: numpy array
    Weights for weighted average.
axis: None or int, optional
    Axis or axes along which to average a.
    The default, axis=None, will average over all of the
    elements of the input array.
    If axis is negative it counts
    from the last to the first axis.

Returns
-------
mase: numpy array or double
    Return the mase along the specified axis.

References
----------
[1] https://robjhyndman.com/papers/mase.pdf</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Mean-Absolute-Error">Mean Absolute Error<a class="anchor-link" href="#Mean-Absolute-Error"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="mae" class="doc_header"><code>mae</code><a href="https://github.com/Nixtla/neuralforecast/tree/main/neuralforecast/losses/numpy.py#L255" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>mae</code>(<strong><code>y</code></strong>:<code>ndarray</code>, <strong><code>y_hat</code></strong>:<code>ndarray</code>, <strong><code>weights</code></strong>:<code>Optional</code>[<code>ndarray</code>]=<em><code>None</code></em>, <strong><code>axis</code></strong>:<code>Optional</code>[<code>int</code>]=<em><code>None</code></em>)</p>
</blockquote>
<p>Calculates Mean Absolute Error (MAE).</p>

<pre><code>Parameters
----------
y: numpy array
    Actual test values.
y_hat: numpy array
    Predicted values.
weights: numpy array
    Weights for weighted average.
axis: None or int, optional
    Axis or axes along which to average a.
    The default, axis=None, will average over all of the
    elements of the input array.
    If axis is negative it counts
    from the last to the first axis.

Returns
-------
mae: numpy array or double
    Return the mae along the specified axis.</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Quantile-Loss">Quantile Loss<a class="anchor-link" href="#Quantile-Loss"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="quantile_loss" class="doc_header"><code>quantile_loss</code><a href="https://github.com/Nixtla/neuralforecast/tree/main/neuralforecast/losses/numpy.py#L295" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>quantile_loss</code>(<strong><code>y</code></strong>:<code>ndarray</code>, <strong><code>y_hat</code></strong>:<code>ndarray</code>, <strong><code>q</code></strong>:<code>float</code>=<em><code>0.5</code></em>, <strong><code>weights</code></strong>:<code>Optional</code>[<code>ndarray</code>]=<em><code>None</code></em>, <strong><code>axis</code></strong>:<code>Optional</code>[<code>int</code>]=<em><code>None</code></em>)</p>
</blockquote>
<p>Calculates the Quantile Loss/Pinball Loss (QL)
that measures the deviation of a quantile forecast.
By weighting the absolute deviation in a non symmetric way, the
loss pays more attention to under or over estimation.
A common value for tau is 0.5 for the deviation from the median.</p>

<pre><code>Parameters
----------
y: numpy array
    Actual test values.
y_hat: numpy array
    Predicted values.
weights: numpy array
    Weights for weighted average.
q: float
    Fixes the quantile against which the predictions are compared.
axis: None or int, optional
    Axis or axes along which to average a.
    The default, axis=None, will average over all of the
    elements of the input array.
    If axis is negative it counts
    from the last to the first axis.

Returns
-------
quantile_loss: numpy array or double
    Return the quantile loss along the specified axis.</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Relative-Mean-Absolute-Error">Relative Mean Absolute Error<a class="anchor-link" href="#Relative-Mean-Absolute-Error"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="rmae" class="doc_header"><code>rmae</code><a href="https://github.com/Nixtla/neuralforecast/tree/main/neuralforecast/losses/numpy.py#L343" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>rmae</code>(<strong><code>y</code></strong>:<code>ndarray</code>, <strong><code>y_hat1</code></strong>:<code>ndarray</code>, <strong><code>y_hat2</code></strong>:<code>ndarray</code>, <strong><code>weights</code></strong>:<code>Optional</code>[<code>ndarray</code>]=<em><code>None</code></em>, <strong><code>axis</code></strong>:<code>Optional</code>[<code>int</code>]=<em><code>None</code></em>)</p>
</blockquote>
<p>Calculates Relative Mean Absolute Error (rMAE).
The relative mean absolute error of two forecasts.
A number smaller than one implies that the forecast in the
numerator is better than the forecast in the denominator.</p>

<pre><code>Parameters
----------
y: numpy array
    Actual test values.
y_hat1: numpy array
    Predicted values of first model.
y_hat2: numpy array
    Predicted values of second model.
weights: numpy array
    Weights for weighted average.
axis: None or int, optional
    Axis or axes along which to average a.
    The default, axis=None, will average over all of the
    elements of the input array.
    If axis is negative it counts
    from the last to the first axis.

Returns
-------
rmae: numpy array or double
    Return the rmae along the specified axis.</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Multi-Quantile-Loss">Multi-Quantile Loss<a class="anchor-link" href="#Multi-Quantile-Loss"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="mqloss" class="doc_header"><code>mqloss</code><a href="https://github.com/Nixtla/neuralforecast/tree/main/neuralforecast/losses/numpy.py#L383" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>mqloss</code>(<strong><code>y</code></strong>:<code>ndarray</code>, <strong><code>y_hat</code></strong>:<code>ndarray</code>, <strong><code>quantiles</code></strong>:<code>ndarray</code>, <strong><code>weights</code></strong>:<code>Optional</code>[<code>ndarray</code>]=<em><code>None</code></em>, <strong><code>axis</code></strong>:<code>Optional</code>[<code>int</code>]=<em><code>None</code></em>)</p>
</blockquote>
<p>Calculates the Multi-Quantile loss (MQL).
Calculates Average Multi-quantile Loss, for
a given set of quantiles, based on the absolute
difference between predicted and true values.</p>

<pre><code>Parameters
----------
y: numpy array
    Actual test values.
y_hat: numpy array (-1, n_quantiles)
    Predicted values.
quantiles: numpy array (n_quantiles)
    Quantiles to estimate from the distribution of y.
weights: numpy array
    Weights for weighted average.
axis: None or int, optional
    Axis or axes along which to average a.
    The default, axis=None, will average over all of the
    elements of the input array.
    If axis is negative it counts
    from the last to the first axis.

Returns
-------
mqloss: numpy array or double
    Return the mqloss along the specified axis.</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

</div>
 

